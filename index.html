<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tracker de HÃ¡bitos</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸŒ™</text></svg>">
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="app">
        <div class="container">
            <header>
                <h1>Tracker de HÃ¡bitos</h1>
                <a href="https://docs.google.com/spreadsheets/d/1035N3vSSAJB-1yqnx_I18U48CTRt2AMp8SWm8_YsSA0/edit"
                   target="_blank"
                   class="spreadsheet-link"
                   title="Ver spreadsheet completo">
                    ðŸ“Š Ver aÃ±o completo
                </a>
            </header>

            <!-- Sync indicator (fixed position) -->
            <div v-if="isSyncing" class="sync-spinner">
                <div class="spinner"></div>
            </div>
            <div v-if="syncStatus && !isSyncing" class="sync-toast" :class="{ error: syncStatus.includes('Error') }">
                {{ syncStatus }}
            </div>

            <div class="date-navigation">
                <button @click="previousDay" class="nav-btn">â—€ Anterior</button>
                <input
                    type="date"
                    v-model="currentDate"
                    @change="loadDayData"
                    class="date-picker"
                />
                <button @click="nextDay" class="nav-btn">Siguiente â–¶</button>
                <button @click="goToToday" class="today-btn">Hoy</button>
            </div>

            <div class="current-date">
                <h2>{{ formattedDate }}</h2>
            </div>

            <div class="day-title">
                <label for="title">TÃ­tulo del dÃ­a:</label>
                <input
                    type="text"
                    id="title"
                    v-model="dayData.title"
                    @input="saveDayData"
                    placeholder="Ej: Un dÃ­a productivo"
                    class="title-input"
                />
            </div>

            <div class="habits-section">
                <h3>HÃ¡bitos del dÃ­a</h3>

                <div class="habit-item mood-item">
                    <label>Mood:</label>
                    <div class="mood-selector">
                        <button
                            v-for="mood in moods"
                            :key="mood.value"
                            @click="setMood(mood.value)"
                            :class="['mood-btn', { active: dayData.habits.mood === mood.value }]"
                            :title="mood.label"
                        >
                            {{ mood.emoji }}
                        </button>
                    </div>
                </div>

                <div class="habits-grid">
                    <div
                        v-for="habit in booleanHabits"
                        :key="habit.key"
                        class="habit-item"
                    >
                        <div class="habit-switch-container">
                            <span class="habit-emoji">{{ habit.emoji }}</span>
                            <label :for="habit.key" class="habit-label">{{ habit.label }}</label>
                            <label class="switch">
                                <input
                                    type="checkbox"
                                    :id="habit.key"
                                    :checked="dayData.habits[habit.key] === true"
                                    @change="toggleHabitSwitch(habit.key, $event)"
                                />
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <div class="notes-section">
                <label for="notes">Notas del dÃ­a (Markdown):</label>
                <textarea
                    id="notes"
                    v-model="dayData.notes"
                    @input="saveDayData"
                    placeholder="Escribe tus notas aquÃ­... Puedes usar markdown"
                    class="notes-textarea"
                    rows="8"
                ></textarea>
                <div class="notes-preview">
                    <h3>Vista previa:</h3>
                    <div v-html="renderedNotes" class="markdown-content"></div>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
